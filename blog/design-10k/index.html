<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Designing a scalable blog platform | DDD</title><link rel=stylesheet href=https://grevyarlesp.github.io/homepage/css/style.css><link rel=stylesheet href=https://grevyarlesp.github.io/homepage/css/fonts.css><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script>
<link rel=icon type=image/svg+xml href=https://grevyarlesp.github.io/homepage/favicon.svg><link rel=icon type=image/png href=https://grevyarlesp.github.io/homepage/favicon.png><link href="http://fonts.googleapis.com/css?family=Pacifico" rel=stylesheet type=text/css><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href="https://fonts.googleapis.com/css2?family=Roboto&display=swap" rel=stylesheet><script type=text/x-mathjax-config>
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script><script type=text/javascript src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script></head><body><nav><ul class=menu><li><a href=https://grevyarlesp.github.io/homepage/>home</a></li><li><a href=https://grevyarlesp.github.io/homepage/blog>blog</a></li></ul><hr></nav><div class=article-meta><h1><span class=title>Designing a scalable blog platform</span></h1><h2 class=date>2022/05/10</h2></div><main><p>A classic system design interview question is to design a blog platform. For this particular question, we design a system that can handle to 10000 requests per second.</p><h2 id=feature-expectations>Feature expectations:</h2><p>Since the question is very open-ended with no clear requirements, I am making up some feature requirements:</p><ul><li>Users can register and log in into their accounts</li><li>Users should be able to write their blogs in Markdown form (provides a markdown editor in client side)</li><li>Users can follow other users.</li><li>Users should be able to view blogs submitted by other users, in form of a feed.</li><li>Blogs can contain images, but no videos.</li></ul><h2 id=estimations>Estimations:</h2><p>These are not accurate numbers, I looked them up from various sources to make our hypothetical design easier to work with:</p><ul><li>Each requests a blog, or send a blog to the server.</li><li>Each blog has 10000 characters (2 bytes for each, 20000 bytes), so each blog is 20KB.</li><li>Each blog may includes image, let&rsquo;s limit each to 2048 pixels (as Blogger does), so each image&rsquo;s size is around $2048 * 3 = 6144$. An average blog has 10 images (my assumption), so the total image size is around 12KB. Total size of an average blog post 32KB.</li><li><strong>Traffic</strong>: We have to serve 10000 requests per second, that puts it at $32 * 10000 = 320000$ KB, or 320MB of throughput per second. Compression is not considered here.</li><li><strong>Storage:</strong> Each of our users submits 2-3 blogs every day, let&rsquo;s put it at 20000-30000 blogs, so each month we have roughly 30GB more data. Or $30 * 365 \approx 11$ TB per year.</li></ul><h2 id=design-goals>Design goals</h2><p>We want our system to be:</p><ul><li>Highly available</li><li>Optimized for read</li><li>Low lantecy (the blogs sent have to be fast)</li><li>Don&rsquo;t have to be very consistent (when a user posts a blog, we don&rsquo;t need to be immediately distributed to other users feed)</li></ul><h2 id=system-apis>System APIs</h2><ul><li><code>POST blog(user_key, blog_data)</code>: returns the URL of new blog.</li><li><code>POST image(user_key, image_data)</code>: uploads an image, return URL of new image.</li><li><code>GET blog(blog_id)</code>: returns URL of blog</li><li><code>GET image(image_id)</code>: returns URL of image</li></ul><h2 id=high-level-design>High level design</h2><p><img src=./img/design.svg alt></p><p>We can sketch out our high level design:</p><ul><li>First, the client calls the load balancer. The load balancer divides up the workload between the web servers, it decides which server to handle each request. A level 4 load balancer should be sufficient.</li><li>The server clusters:</li><li>File storage stores our files: the markdown files and the image files.</li></ul><h2 id=deep-dive>Deep dive</h2><p>Let&rsquo;s take a deep dive into each component of our design.</p><h3 id=database-schemas>Database schemas</h3><h2 id=references>References:</h2><ul><li>The template from: <a href=https://leetcode.com/discuss/career/229177/My-System-Design-Template>https://leetcode.com/discuss/career/229177/My-System-Design-Template</a></li><li><a href=https://github.com/donnemartin/system-design-primer>https://github.com/donnemartin/system-design-primer</a></li></ul></main><footer></footer></body></html>